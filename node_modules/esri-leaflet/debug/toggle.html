<!DOCTYPE html>
  <html>
  <head>
    <meta charset=utf-8 />
    <title>Esri Leaflet Debugging Sample</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <!-- Load Leaflet -->
    <link rel="stylesheet" href="../node_modules/leaflet/dist/leaflet.css" />
    <script src="../node_modules/leaflet/dist/leaflet.js"></script>

    <!-- Load Esri Leaflet from source-->
    <script src="../dist/esri-leaflet.js"></script>

    <style>
      body {
        margin:0;
        padding:0;
      }

      #map {position: absolute;top:25px;bottom:0;right:0;left:0;}

      #info-pane {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 1000;
        padding: 1em;
        background: white;
      }

      #btn-toggle{ 
        cursor: pointer; 
        padding:5px; 
        background-color:#bbb;
        z-index: 1000;
      }
    </style>
  </head>
  <body>
  <a id="btn-toggle" onclick="addRemove()">addLayer</a>
  <div id="map"></div>
  <div id="info-pane" class="leaflet-bar">
    <label>
    sample application for debugging
    </label>
  </div>

  <script>
var map = L.map('map').setView([34.025, -116.203], 6);
var layer = L.esri.featureLayer({url: 'http://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/USA_County_Crops_2007/FeatureServer/0',
    opacity: 0.5
});

L.esri.basemapLayer('Gray').addTo(map);

// super quick add and remove to illustrate bug.
// even tough the layer has been removed you will still see the
// image tile from the layer on the map.
//map.addLayer(layer);
//map.removeLayer(layer);

//Can manually toggle if you want. toggle quickly to see bug:
var toggleState = true;

function addRemove() {
  if(toggleState){        
        map.addLayer(layer);
        document.getElementById('btn-toggle').innerHTML = 'removeLayer';
    } else {
        map.removeLayer(layer);
        document.getElementById('btn-toggle').innerHTML = 'addLayer';
    }
    toggleState = !toggleState;
}
  </script>

  </body>
  </html>